<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>–í—ã–±–æ—Ä –∞–¥—Ä–µ—Å–∞</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            background: #f0f0f0;
        }
        button {
            width: 100%;
            padding: 20px;
            font-size: 24px;
            background: #007AFF;
            color: white;
            border: none;
            border-radius: 15px;
            margin: 10px 0;
            cursor: pointer;
        }
        #status {
            margin-top: 20px;
            font-size: 16px;
            color: #666;
            text-align: center;
        }
    </style>
</head>
<body>
    <button onclick="sendTestData()">üìç –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –∞–¥—Ä–µ—Å</button>
    <div id="status">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏</div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
        let tg = window.Telegram?.WebApp;
        
        if (tg) {
            tg.ready();
            tg.expand();
            document.getElementById('status').innerText = '‚úÖ Telegram WebApp –≥–æ—Ç–æ–≤';
            console.log('Telegram WebApp –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
        } else {
            document.getElementById('status').innerText = '‚ùå –û—à–∏–±–∫–∞: –Ω–µ –≤ Telegram';
        }

        function sendTestData() {
            document.getElementById('status').innerText = '–û—Ç–ø—Ä–∞–≤–∫–∞...';
            
            // –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
            const testData = {
                lat: 41.311081,
                lon: 69.240562,
                address: "–¢–∞—à–∫–µ–Ω—Ç, —Ç–µ—Å—Ç–æ–≤—ã–π –∞–¥—Ä–µ—Å"
            };
            
            console.log('–û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö:', testData);
            
            if (tg) {
                try {
                    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
                    tg.sendData(JSON.stringify(testData));
                    document.getElementById('status').innerText = '‚úÖ –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã!';
                    console.log('–î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã, –∑–∞–∫—Ä—ã–≤–∞–µ–º');
                    // –ó–∞–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É
                    setTimeout(() => tg.close(), 1000);
                } catch (e) {
                    document.getElementById('status').innerText = '‚ùå –û—à–∏–±–∫–∞: ' + e.message;
                    console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏:', e);
                }
            } else {
                alert('–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º:\n' + JSON.stringify(testData));
                document.getElementById('status').innerText = '‚úÖ –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã (—Ç–µ—Å—Ç)';
            }
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ WebApp –¥–æ—Å—Ç—É–ø–µ–Ω
        console.log('tg.sendData –¥–æ—Å—Ç—É–ø–µ–Ω:', typeof tg?.sendData === 'function');
    </script>
</body>
</html>
